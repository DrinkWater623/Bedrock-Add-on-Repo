{
	"$module": "sickle",
	"$scope":{
		"local_leaf3":"{{global_log3.filter(x => x.leaf3_sfx > '')}}",
		"local_leaf3_alt":"{{global_log3.filter(x => x.alt_give_leaf3 > '')}}",

		"local_nature_sickle_1_item_name" :"{{global_nature_loot.filter(x => x.is_block == 1 && x.bit_hoe == 1 && x.block_state_name == '' && x.give_name == '')}}",
		"local_nature_sickle_2_give_name" :"{{global_nature_loot.filter(x => x.is_block == 1 && x.bit_hoe == 1 && x.block_state_name == '' && x.give_name >  '')}}",

		"local_nature_soft_1_item_name":"{{global_nature_loot.filter(x => x.is_block == 1 && x.bit_hoe == 0 && x.bit_shovel == 1 && x.block_state_name == '' && x.give_name == '')}}",
		"local_nature_soft_2_give_name":"{{global_nature_loot.filter(x => x.is_block == 1 && x.bit_hoe == 0 && x.bit_shovel == 1 && x.block_state_name == '' && x.give_name >  '')}}",
		"local_ptr_1_or_2":[
			{"ptr":1,"addon":""},
			{"ptr":2,"addon":"2"}
		]
	},	
	"$template":{
		"$format_version": "{{settings.item_digger_version}}",
		"minecraft:item": {
			"description": {
				"category": "equipment"
				/*
				This is 1.20.20+ so cannot use it
				"menu_category": {  
					"group": "itemGroup.name.axe",  
					"category": "equipment", 
					"is_hidden_in_commands": true 
				}
				*/
			},
			"components": {
				//"tag:minecraft:is_tool": {},				
				"minecraft:cooldown":{"category":"attack","duration":"{{=cooldown_duration}}"},
				"minecraft:creative_category": {"parent": "itemGroup.name.hoe"},	
				"minecraft:damage": "{{=attack_damage}}",					
				// Since Digger can do the minion with a chop, maybe let right click on a leaf silk one leaf
				// "minecraft:on_use_on": {"on_use_on": {"event": "ev:place_entity"}},
				"minecraft:digger": {					
					"destroy_speeds": [	
						//=============================================================================================================						
						{"{{#sickle_digger_tags}}":{"block":{"tags":"query.any_tag('{{tag}}')"}		,"speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_any_landscape"}}},
						{"{{#local_nature_sickle_1_item_name}}":{"block":"minecraft:{{item_name}}"	,"speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_any_landscape"}}},
						{"{{#local_nature_sickle_2_give_name}}":{"block":"minecraft:{{give_name}}"	,"speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_any_landscape"}}},
						//=============================================================================================================						
						//Bamboo and sugar cane OK
						{"block":"minecraft:bamboo","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_bamboo"}},
						{"block":"minecraft:reeds","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_sugar_cane"}},
						//=============================================================================================================						
						//Leaf Chopped - any.. only Axe will do certain one while doing certain tree
						//=============================================================================================================
						//Leaf Chopped - Silk Touch
						{"{{?local_settings.enchantment == 'silk_touch'}}":{"block":"minecraft:leaves","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:process_for_leaf_1"}}},
						{"{{?local_settings.enchantment == 'silk_touch'}}":{"block":"minecraft:leaves2","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:process_for_leaf_2"}}},
						{"{{?local_settings.enchantment == 'silk_touch'}}":{"{{#local_leaf3}}":{"block":"minecraft:{{log3_name}}_{{leaf3_sfx}}","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:process_for_{{log3_name}}_{{leaf3_sfx}}"}}}},
						{"{{?local_settings.enchantment == 'silk_touch'}}":{"{{#local_leaf3_alt}}":{"block":"minecraft:{{alt_give_leaf3}}","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:process_for_{{alt_give_leaf3}}"}}}},
						//=============================================================================================================
						//Leaf Chopped - Efficiency
						{"{{?local_settings.enchantment == 'efficiency'}}":{"block":"minecraft:leaves","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_any_leaf"}}},
						{"{{?local_settings.enchantment == 'efficiency'}}":{"block":"minecraft:leaves2","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_any_leaf"}}},
						{"{{?local_settings.enchantment == 'efficiency'}}":{"{{#local_leaf3}}":{"block":"minecraft:{{log3_name}}_{{leaf3_sfx}}","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_any_leaf"}}}},
						{"{{?local_settings.enchantment == 'efficiency'}}":{"{{#local_leaf3_alt}}":{"block":"minecraft:{{alt_give_leaf3}}","speed":"{{=wood_destroy_speed*2}}","on_dig":{"event":"ev:summon_for_any_leaf"}}}},
						//=============================================================================================================						
						// soft like sand, something an axe would just sink into and not really do anything
						{"{{#scooper_digger_tags}}"	 :{"block":{"tags":"query.any_tag('{{tag}}')"},"speed":"{{=wood_destroy_speed*0.1}}"}},
						{"{{#scooper_digger_blocks}}":{"block":"minecraft:{{block_name}}","speed":"{{=wood_destroy_speed*0.1}}"}}
						//=============================================================================================================						
					],
					"on_dig": {
						"speed": 0 //,"event": "ev:damage_default"
					}
				},		
				"minecraft:hand_equipped": true,
				"minecraft:max_stack_size": 1
			},
			"events": {
				//================================================================================================
				// Needed because MC throw a content error log thingy if it does not exist if you use tag=is_axe
				"on_tool_used":  {"run_command":{"command":["say on_tool_used event"],"target":"block"}},
				//================================================================================================
				"ev:summon_for_bamboo":{
					"sequence":[
						{
							"{{? material != 'netherite'}}":	{
								"run_command": {"command": [
									"title @p title §aBamboo (r={{radius_max+1}})",
									"summon dw623:bamboo_minion_{{radius_max}} ~ ~ ~"]
									,"target":"block"
								}
							}
						},
						{
							"{{? material == 'netherite'}}":	{
								"run_command": {"command": [
									"title @p title §aBamboo",
									"summon dw623:bamboo_minion ~ ~ ~"]
									,"target":"block"
								}
							}
						}
					]
				},
				"ev:summon_for_sugar_cane":{
					"sequence":[
						{
							"{{? material != 'netherite'}}":	{
								"run_command": {"command": [
									"title @p title §eSugar Cane (r={{radius_max+1}})",
									"summon dw623:sugar_cane_minion_{{radius_max}} ~ ~ ~"]
									,"target":"block"
								}
							}
						},
						{
							"{{? material == 'netherite'}}":	{
								"run_command": {"command": [
									"title @p title §eSugar Cane",
									"summon dw623:sugar_cane_minion ~ ~ ~"]
									,"target":"block"
								}
							}
						}
					]
				},
		//Need to sep the stuff that needs to loot cause it would be destroyed. minion needs to know loot or not
				"ev:summon_for_any_landscape":{
					"sequence":[					
						{
							"run_command": {"command": [
								"title @p title §bLandscaping",
								"summon dw623:landscape_minion_{{radius_max}} ~ ~ ~ 0 0 ev:{{local_settings.enchantment}}_activate_landscape"]
								,"target":"block"
							}
						}
					]
				},
				"ev:summon_for_any_leaf":{
					"sequence":[					
						{
							"run_command": {"command": [
								"title @p title §aLeaves",
								"summon dw623:leaf_minion_{{radius_max}} ~ ~ ~ 0 0 ev:{{local_settings.enchantment}}_activate_leaf"]
								,"target":"block"
							}
						}
					]
				},
				"ev:summon_for_any_crop":{
					"sequence":[					
						{
							"run_command": {"command": [
								"title @p title §eCrops",
								"summon dw623:crops_minion ~ ~ ~"]
								,"target":"block"
							}
						}
					]
				},
				//=================================================
				// Leaf Group 1 and 2 - best I can do until they are flattened out
				// NOTE: THESE ARE NOT SAME AS AXE EVENTS OF SAME NAME - DO NOT CARE WHAT LEAF TYPE
				//=================================================							
								
				//===============================================================================================================
				"{{? local_settings.enchantment == 'silk_touch'}}":{
					"{{#local_ptr_1_or_2}}":{
						"ev:process_for_leaf_{{ptr}}": {
							"sequence": [												
								{"trigger":"ev:setblock_leaf_{{ptr}}"},
								{"trigger":"ev:summon_for_any_leaf"}						
							]
						},
						"ev:setblock_leaf_{{ptr}}": {
							//put leaf back from a surrounding leaf, in Y X Z order... if not a solitary leaf, then should match something, so use that.
							"sequence": [						
								// pos=y 1st
								{															
									"run_command":{"command":[
										{"{{#squiggly_pos.filter(x => x.pos == 2)}}":
											[
												"execute unless ~ ~ ~  minecraft:leaves{{addon}} if block {{p75}} minecraft:leaves{{addon}} run tell @p[tag=debug] Clone Y Leaf-{{ptr}}",
												"execute unless ~ ~ ~  minecraft:leaves{{addon}} if block {{p75}} minecraft:leaves{{addon}} run clone {{p75}}  {{p75}}  ~ ~ ~ "
											]
										}],
										"target":"block"
									}
								},
								{															
									"run_command":{"command":[
										{"{{#squiggly_pos.filter(x => x.pos != 2)}}":
										[
											"execute unless ~ ~ ~  minecraft:leaves{{addon}} unless block ~ ~-1 ~ minecraft:leaves{{addon}} unless block ~ ~1 ~ minecraft:leaves{{addon}} if block {{p75}} minecraft:leaves{{addon}} run tell @p[tag=debug] Clone X/Z Leaf-2",
											"execute unless ~ ~ ~  minecraft:leaves{{addon}} unless block ~ ~-1 ~ minecraft:leaves{{addon}} unless block ~ ~1 ~ minecraft:leaves{{addon}} if block {{p75}} minecraft:leaves{{addon}} run clone {{p75}}  {{p75}}  ~ ~ ~ "
										]
										}],
										"target":"block"
									}
								}						
							]
						}
					},					
					"{{#local_leaf3}}":{					
						"ev:process_for_{{log3_name}}_{{leaf3_sfx}}":{
							"sequence":[
								{"run_command":{"command":["setblock ~ ~ ~ minecraft:{{log3_name}}_{{leaf3_sfx}}"],"target":"block"}},
								{"trigger":"ev:summon_for_any_leaf"}
							]
						}
					},
					"{{#local_leaf3_alt}}":{					
						"ev:process_for_{{alt_give_leaf3}}":{
							"sequence":[
								{"run_command":{"command":["setblock ~ ~ ~ minecraft:{{alt_give_leaf3}}"],"target":"block"}},
								{"trigger":"ev:summon_for_any_leaf"}
							]
						}
					}
				} // end of only if silk-touch
			} // end of events
		}
	}
}